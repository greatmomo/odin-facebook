<%# loop across all users and show them with variable friend request buttons %>


<div class="column is-2 is-offset-5">
  <div class="box">
    <table class="table">
      <% if params[:mode] == "accepted" %>
        <thead>Friends</thead>
      <% else %>
        <thead>Request a friend</thead>
      <% end %>
      
      <% @users.each do |user| %>
        <% unless current_user == user %>
          
              <% if params[:mode] == "accepted" %>
                <% if current_user.requestStatus(user) == "accepted" %>
                <tr>
                  <td>
                    <div class="span"><%= user.name %></div>
                  </td>
          
                  <td>
                    <span class="icon">
                      <i class="fa-solid fa-user-check"></i>
                    </span>
                  </td>
                </tr>
                <% end %>

              <% else %>
                <% if current_user.requestStatus(user) == "pending" %>
                  <tr>
                    <td>
                      <div class="span"><%= user.name %></div>
                    </td>
          
                    <td>
                      <span class="icon">
                        <i class="fa-solid fa-clock"></i>
                      </span>
                    </td>
                  </tr>

                <% elsif current_user.requestStatus(user) == "accepted" %>
                  <%= p "this is not a thing" %>

                <% else %>
                  <tr>
                    <td>
                      <div class="span"><%= user.name %></div>
                    </td>
          
                    <td>
                      <%= simple_form_for :friendRequest do |f| %>
                        <%= f.error_notification %>

                        <%= f.input :requester_id, :input_html => { :value => current_user.id }, wrapper_html: { class: 'is-hidden' } %>

                        <div class="field">
                          <div class="control">
                            <%= f.input :receiver_id,
                                        required: true,
                                        input_html: { :value => user.id },
                                        wrapper: false,
                                        label_html: { class: "label" } %>
                          </div>
                        </div>

                        <div class="field">
                          <div class="control">
                            <%= f.button :submit, "Add Friend", class: "button is-info is-medium" %>
                          </div>
                        </div>

                      <% end %>
                    </td>
                  </tr>
                <% end %>
              <% end %>
            </td>
          </tr>
        <% end %>
      <% end %>
    </table>
  </div>
</div>
